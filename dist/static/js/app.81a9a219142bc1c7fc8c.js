webpackJsonp([1],{EzV3:function(e,t){},KHeQ:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("7+uW"),i=n("mvHQ"),o=n.n(i),a=n("YOBo"),r=n.n(a),c={name:"LoginForm",data:function(){return{username:"",password:"",responseText:null}},computed:{formIncomplete:function(){return!this.username||!this.password}},methods:{doLogin:function(){var e=this;fetch(this.server+"/login",{method:"POST",headers:{"content-type":"application/json"},body:o()({user:this.username,password:this.password})}).then(function(e){return e.json()}).then(function(t){t.ok?(e.$emit("login-data",t),e.username="",e.password=""):"AuthenticationFailed"===t.user?e.responseText="Invalid username / password":e.responseText="Something went wrong."})},addUser:function(){var e=this;fetch(this.server+"/new-user",{method:"POST",headers:{"content-type":"application/json"},body:o()({user:this.username,password:this.password})}).then(function(e){return e.json()}).then(function(t){t.user?e.responseText="User "+t.user+" has been created.":"DuplicateKey"===t.codeName?e.responseText="Username already in use.":e.responseText="Something went wrong."})}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-menu"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{autofocus:"",placeholder:"Username"},domProps:{value:e.username},on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.doLogin(t):null},input:function(t){t.target.composing||(e.username=t.target.value)}}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{placeholder:"Password",type:"password"},domProps:{value:e.password},on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.doLogin(t):null},input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),e.responseText?n("div",{staticStyle:{"text-align":"center"}},[e._v(e._s(e.responseText))]):e._e(),e._v(" "),n("button",{staticClass:"button",class:{"disabled-button":e.formIncomplete},attrs:{disabled:e.formIncomplete},on:{click:e.doLogin}},[e._v("Login >")]),e._v(" "),n("button",{staticClass:"button",class:{"disabled-button":e.formIncomplete},attrs:{disabled:e.formIncomplete},on:{click:e.addUser}},[e._v("Register >")])])},staticRenderFns:[]};var u={name:"App",components:{"login-form":n("VU/8")(c,l,!1,function(e){n("WDc8")},"data-v-3c295b58",null).exports},data:function(){return{connectedToDb:!1,loginFormVisible:!1,activeUser:null,icons:{user:r.a}}},methods:{assignLoginData:function(e){this.activeUser=e.user,this.loginFormVisible=!1},useDefaultUser:function(){var e=this;fetch(this.server+"/login",{method:"POST",headers:{"content-type":"application/json"},body:o()({user:"default",password:"default"})}).then(function(e){return e.json()}).then(function(t){e.assignLoginData(t)})}},created:function(){this.useDefaultUser()}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"top-bar"},[n("img",{attrs:{src:"https://via.placeholder.com/250x75",alt:"logo"}}),e._v(" "),"default"===e.activeUser||null===e.activeUser?n("div",[n("button",{staticClass:"button login-button",on:{click:function(t){e.loginFormVisible=!e.loginFormVisible}}},[e._v("Login / Register")])]):n("div",{staticClass:"user"},[n("button",{staticClass:"button",on:{click:e.useDefaultUser}},[e._v("Logout")]),e._v(" "),n("font-awesome-icon",{attrs:{icon:e.icons.user,size:"2x"}}),e._v("\n      "+e._s(e.activeUser)+"\n    ")],1)]),e._v(" "),e.loginFormVisible?n("div",{staticClass:"login-menu-container"},[n("login-form",{on:{"login-data":function(t){e.assignLoginData(t)}}})],1):e._e(),e._v(" "),n("div",{staticClass:"header",on:{click:function(t){e.$router.push("/prizes")}}},[n("h1",[e._v("Rewards")])]),e._v(" "),n("transition",{attrs:{name:"fade",mode:"out-in"}},[e.activeUser?n("div",{key:"loaded",staticClass:"router-container"},[n("router-view")],1):n("div",{key:"loading",staticClass:"loading"},[n("span",[e._v("Loading...")])])]),e._v(" "),e._m(0)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"footer"},[t("span",[this._v("Terms & Conditions | ")]),t("span",[this._v("Privacy Policy")])])}]};var p=n("VU/8")(u,d,!1,function(e){n("NVeU")},null,null).exports,m=n("/ocq"),v={name:"Prizes",data:function(){return{prizeList:null,loading:!0}},created:function(){var e=this;fetch(this.server+"/prize-list").then(function(e){return e.json()}).then(function(t){e.loading=!1,e.prizeList=t})}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"component"},[n("h2",[e._v("Here is the full list of prizes that you can win.")]),e._v(" "),n("transition",{attrs:{name:"fade",mode:"out-in"}},[e.loading?n("div",{key:"loading",staticClass:"loading"},[n("span",[e._v("Loading...")])]):n("div",{key:"prizes",staticClass:"prize-list"},e._l(e.prizeList,function(t){return n("div",{staticClass:"prize"},[n("img",{attrs:{src:t.image_url,alt:t.name}}),e._v(" "),n("div",{staticClass:"prize-info"},[n("div",{staticClass:"prize-text"},[e._v("Win a "+e._s(t.name))]),e._v(" "),n("div",[n("router-link",{staticClass:"button",attrs:{to:"/details/"+t._id}},[e._v("Redeem >")])],1)])])}))])],1)},staticRenderFns:[]};var _=n("VU/8")(v,f,!1,function(e){n("EzV3")},"data-v-40e2910a",null).exports,h=n("KeE0"),g=n.n(h),z={name:"Modal",data:function(){return{stage:0,responseMsg:null,icons:{close:g.a}}},props:["prize"],methods:{redeemPrize:function(){var e=this;fetch(this.server+"/redeem-prize",{method:"POST",body:o()({prizeId:this.prize._id,quantity:this.prize.quantity}),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){t.ok?1===t.nModified?e.stage++:(e.responseMsg="Sorry. This item is sold out.",e.$props.prize.quantity=0):"Unauthorized"===t.codeName?e.responseMsg="You must be logged in to redeem a prize.":e.responseMsg="Something went wrong."})}}},b={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal-bg"},[0===e.stage?n("div",{staticClass:"modal"},[n("font-awesome-icon",{attrs:{icon:e.icons.close,size:"2x"},on:{click:function(t){e.$emit("close-modal")}}}),e._v(" "),n("h2",[e._v("Are you sure?")]),e._v(" "),n("img",{attrs:{src:e.$props.prize.image_url,alt:e.$props.prize.name}}),e._v(" "),n("p",[e._v("Redeem for "+e._s(e.$props.prize.name)+"?")]),e._v(" "),e.responseMsg?n("div",{staticStyle:{color:"red"}},[e._v(e._s(e.responseMsg))]):e._e(),e._v(" "),n("div",[n("button",{staticClass:"button",class:{"disabled-button":e.$props.prize.quantity<1},attrs:{disabled:e.$props.prize.quantity<1},on:{click:e.redeemPrize}},[e._v("Yes")]),e._v(" "),n("button",{staticClass:"button cancel-button",on:{click:function(t){e.$emit("close-modal")}}},[e._v("Cancel")])])],1):n("div",{staticClass:"modal"},[n("font-awesome-icon",{attrs:{icon:e.icons.close,size:"2x"},on:{click:function(t){e.$emit("close-modal")}}}),e._v(" "),n("h2",[e._v("Congratulations!")]),e._v(" "),n("p",[e._v("You redeemed "+e._s(e.$props.prize.name))]),e._v(" "),n("router-link",{staticClass:"button",attrs:{to:"/prizes"}},[e._v("More Prizes")])],1)])},staticRenderFns:[]};var y={name:"Details",components:{modal:n("VU/8")(z,b,!1,function(e){n("tLWo")},null,null).exports},data:function(){return{prize:null,modalDisplayed:!1}},created:function(){var e=this,t=encodeURI(this.$route.params.prize);fetch(this.server+"/prize?prizeId="+t).then(function(e){return e.json()}).then(function(t){e.prize=t})}},C={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"component"},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[e.prize?n("div",{key:"prize"},[n("div",{staticClass:"grid"},[n("img",{attrs:{src:e.prize.image_url,alt:e.prize.name}}),e._v(" "),n("div",{staticClass:"prize-form"},[n("h2",[e._v(e._s(e.prize.name))]),e._v(" "),n("button",{staticClass:"button",class:{"disabled-button":e.prize.quantity<1},attrs:{disabled:e.prize.quantity<1},on:{click:function(t){e.modalDisplayed=!0}}},[e._v("Redeem >")]),e._v(" "),n("span",[e._v(e._s(e.prize.quantity)+" left in stock")])]),e._v(" "),n("div",{staticClass:"description"},[n("h3",[e._v("Description")]),e._v("\n          "+e._s(e.prize.description)+"\n        ")])])]):n("div",{key:"loading",staticClass:"loading"},[n("span",[e._v("Loading...")])])]),e._v(" "),n("transition",{attrs:{name:"fade"}},[e.modalDisplayed?n("modal",{attrs:{prize:e.prize},on:{"close-modal":function(t){e.modalDisplayed=!1}}}):e._e()],1)],1)},staticRenderFns:[]};var w=n("VU/8")(y,C,!1,function(e){n("KHeQ")},"data-v-81f090ee",null).exports;s.a.use(m.a);var k=new m.a({routes:[{path:"/prizes",component:_},{path:"/details/:prize",component:w},{path:"*",redirect:"/prizes"}]}),U=(n("QxPg"),n("U0v6")),x=n.n(U);s.a.component("font-awesome-icon",x.a),s.a.config.productionTip=!1,s.a.mixin({data:function(){return{server:"localhost:8080"===location.host?"http://localhost:3636":""}}}),new s.a({el:"#app",router:k,components:{App:p},template:"<App/>"})},NVeU:function(e,t){},WDc8:function(e,t){},tLWo:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.81a9a219142bc1c7fc8c.js.map